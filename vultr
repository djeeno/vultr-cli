#!/bin/sh
# shellcheck disable=SC1090

##
# If in non interactive shell ( "$-" not containing "i" ),
# execute script as command.
##
if ! { echo "$-" | grep -q i; }; then
# -- Non Interactive ----------------

# If an error occurs, EXIT abnormally.
set -e -o pipefail

##
# constants
##
VULTR_VERSION='0.0.3'
VULTR_PROGRAM_NAME="$(basename -- "$0")"



##
# common
##
VultrPrintStderr() {
  echo "$*" 1>&2
}

CheckDependency() { (
  for cmd in "$@"; do
    if ! command -v -- "${cmd}" >/dev/null; then
      VultrPrintStderr "\"${cmd}\" not found in \$PATH"
      exit 1
    fi
  done
)}

VULTR_CREDENTIALS_FILE="$HOME/.vultr/credentials"

VultrConfigure() {
  if [ -e "${VULTR_CREDENTIALS_FILE}" ]; then
    VultrPrintStderr "already exist: ${VULTR_CREDENTIALS_FILE}"
    exit 1
  fi
  mkdir -p "$(dirname -- "${VULTR_CREDENTIALS_FILE}")"
  echo "ref. https://my.vultr.com/settings/#settingsapi"
  stty -echo
  printf '%s' 'Vultr API key: '
  read -r VultrAPIKey
  stty echo
  echo
  if [ -z "${VultrAPIKey}" ]; then
    VultrPrintStderr "Vultr API key not set"
    exit 1
  fi
  echo "VultrAPIKey=${VultrAPIKey}" | tee "${VULTR_CREDENTIALS_FILE}" 1>/dev/null
  chown -R "$(id -u)":"$(id -g)" "$(dirname -- "${VULTR_CREDENTIALS_FILE}")"
  chmod -R go-rwx "$(dirname -- "${VULTR_CREDENTIALS_FILE}")"
}

VultrSetCredentials() {
  if [ -f "${VULTR_CREDENTIALS_FILE}" ] && [ -r "${VULTR_CREDENTIALS_FILE}" ]; then
    . "${VULTR_CREDENTIALS_FILE}"
  else
    VultrPrintStderr "Credentials file does not found: ${VULTR_CREDENTIALS_FILE}"
    VultrPrintStderr "For set credentials, run:"
    VultrPrintStderr "  $ vultr configure"
    exit 1
  fi
}

VultrJSON() {
  if command -v jq 1>/dev/null; then
    "$(command -v jq)" . < /dev/stdin
  elif command -v python 1>/dev/null; then
    "$(command -v python)" -m json.tool < /dev/stdin
  elif command -v ruby 1>/dev/null; then
    "$(command -v ruby)" -r json -e 'puts JSON.pretty_generate(JSON.parse(STDIN.read))' < /dev/stdin
  elif command -v perl 1>/dev/null; then
    # shellcheck disable=SC2016
    "$(command -v perl)" -MEncode -MJSON::PP -e '$json=JSON::PP->new->pretty; $obj=$json->decode(decode_utf8(join("",(<STDIN>)))); print encode_utf8($json->encode($obj))'
  else
    # plain output
    cat /dev/stdin
  fi
}



##
# account
##
VultrAccountInfo() {
  # ref. https://www.vultr.com/api/#account_info
  CheckDependency curl
  VultrSetCredentials
  vultrAPIResponse=$(curl -sS -H "API-Key: ${VultrAPIKey}" -X GET "https://api.vultr.com/v1/account/info")
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}



##
# firewall
##
VultrFirewallGroupCreate() {
  # ref. https://www.vultr.com/api/#firewall_group_create
  CheckDependency curl
  vultrFirewallGroupDescription="${1:?"$(printf '\n%s' "Set \$1: description string (optional) Description of firewall group.")"}"
  VultrSetCredentials
  vultrAPIResponse=$(
    curl -sS -H "API-Key: ${VultrAPIKey}" -X POST "https://api.vultr.com/v1/firewall/group_create" \
      -d "description=${vultrFirewallGroupDescription}" \
  )
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}

VultrFirewallGroupDelete() {
  # ref. https://www.vultr.com/api/#firewall_group_delete
  CheckDependency curl
  vultrFirewallGroupID="${1:?"$(printf '\n%s' "Set \$1: FIREWALLGROUPID string Firewall group to delete." "See:" "  $ vultr firewall group-list")"}"
  VultrSetCredentials
  vultrAPIResponse=$(
    curl -sS -H "API-Key: ${VultrAPIKey}" -X POST "https://api.vultr.com/v1/firewall/group_delete" \
      -d "FIREWALLGROUPID=${vultrFirewallGroupID}" \
  )
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}

VultrFirewallGroupList() {
  # ref. https://www.vultr.com/api/#firewall_group_list
  CheckDependency curl
  VultrSetCredentials
  vultrAPIResponse=$(curl -sS -H "API-Key: ${VultrAPIKey}" -X GET "https://api.vultr.com/v1/firewall/group_list")
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}



##
# network
##
VultrNetworkCreate() {
  # ref. https://www.vultr.com/api/#network_create
  CheckDependency curl
  vultrNetworkDCID="${1:?"$(printf '\n%s\n%s\n%s' "Set \$1: DCID integer Location for the network." "See:" "  $ vultr regions list")"}"
  VultrSetCredentials
  vultrAPIResponse=$(
    curl -sS -H "API-Key: ${VultrAPIKey}" -X POST "https://api.vultr.com/v1/network/create" \
      -d "DCID=${vultrNetworkDCID}" \
  )
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}

VultrNetworkCreateWithOptional() {
  # ref. https://www.vultr.com/api/#network_create
  CheckDependency curl
  vultrNetworkDCID="${1:?"$(printf '\n%s\n%s\n%s' "Set \$1: DCID integer Location for the network." "See:" "  $ vultr regions list")"}"
  vultrNetworkDescription="${2:?"$(printf '\n%s' "Set \$2: description string (optional) Description of network.")"}"
  vultrNetworkV4Subnet="${3:?"$(printf '\n%s' "Set \$3: v4_subnet string (optional) IPv4 network to be used when attaching servers to this network.")"}"
  vultrNetworkV4SubnetMask="${4:?"$(printf '\n%s' "Set \$4: v4_subnet_mask int (optional) Network mask corresponding with the v4_subnet.")"}"
  VultrSetCredentials
  vultrAPIResponse=$(
    curl -sS -H "API-Key: ${VultrAPIKey}" -X POST "https://api.vultr.com/v1/network/create" \
      -d "DCID=${vultrNetworkDCID}" \
      -d "description=${vultrNetworkDescription}" \
      -d "v4_subnet=${vultrNetworkV4Subnet}" \
      -d "v4_subnet_mask=${vultrNetworkV4SubnetMask}"
  )
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}

VultrNetworkList() {
  # ref. https://www.vultr.com/api/#network_network_list
  CheckDependency curl
  VultrSetCredentials
  vultrAPIResponse=$(curl -sS -H "API-Key: ${VultrAPIKey}" -X GET "https://api.vultr.com/v1/network/list")
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}



##
# os
##
VultrOSList() {
  # ref. https://www.vultr.com/api/#os_os_list
  CheckDependency curl
  VultrSetCredentials
  vultrAPIResponse=$(curl -sS -H "API-Key: ${VultrAPIKey}" -X GET "https://api.vultr.com/v1/os/list")
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}



##
# plans
##
VultrPlansList() {
  # ref. https://www.vultr.com/api/#plans_plan_list
  CheckDependency curl
  VultrSetCredentials
  vultrAPIResponse=$(curl -sS -H "API-Key: ${VultrAPIKey}" -X GET "https://api.vultr.com/v1/plans/list")
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}



##
# regions
##
VultrRegionsList() {
  # ref. https://www.vultr.com/api/#regions_region_list
  CheckDependency curl
  VultrSetCredentials
  vultrAPIResponse=$(curl -sS -H "API-Key: ${VultrAPIKey}" -X GET "https://api.vultr.com/v1/regions/list")
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}



##
# server
##
VultrServerCreate() {
  # ref. https://www.vultr.com/api/#server_create
  CheckDependency curl
  vultrServerDCID="${1:?"$(printf '\n%s\n%s\n%s' "Set \$1: DCID integer Location to create this virtual machine in." "See:" "  $ vultr regions list")"}"
  vultrServerVPSPLANID="${2:?"$(printf '\n%s\n%s\n%s' "Set \$2: VPSPLANID integer Plan to use when creating this virtual machine." "See:" "  $ vultr plans list")"}"
  vultrServerOSID="${3:?"$(printf '\n%s\n%s\n%s' "Set \$3: OSID integer Operating system to use." "See:" "  $ vultr os list")"}"
  VultrSetCredentials
  vultrAPIResponse=$(
    curl -sS -H "API-Key: ${VultrAPIKey}" -X POST "https://api.vultr.com/v1/server/create" \
      -d "DCID=${vultrServerDCID}" \
      -d "VPSPLANID=${vultrServerVPSPLANID}" \
      -d "OSID=${vultrServerOSID}"
  )
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}

VultrServerCreateWithOptional() {
  # ref. https://www.vultr.com/api/#server_create
  CheckDependency curl
  vultrServerDCID="${1:?"$(printf '\n%s\n%s\n%s' "Set \$1: DCID integer Location to create this virtual machine in." "See:" "  $ vultr regions list")"}"
  vultrServerVPSPLANID="${2:?"$(printf '\n%s\n%s\n%s' "Set \$2: VPSPLANID integer Plan to use when creating this virtual machine." "See:" "  $ vultr plans list")"}"
  vultrServerOSID="${3:?"$(printf '\n%s\n%s\n%s' "Set \$3: OSID integer Operating system to use." "See:" "  $ vultr os list")"}"
  vultrServerEnablePrivateNetwork="${4:?"$(printf '\n%s' "Set \$4: enable_private_network string (optional) 'yes' or 'no'. If yes, private networking support will be added to the new server.")"}"
  vultrServerBase64EncodedUserData="${5:?"$(printf '\n%s' "Set \$5: userdata string (optional) Base64 encoded user-data")"}"
  vultrServerTag="${6:?"$(printf '\n%s' "Set \$6: tag string (optional) The tag to assign to this server.")"}"
  VultrSetCredentials
  vultrAPIResponse=$(
    curl -sS -H "API-Key: ${VultrAPIKey}" -X POST "https://api.vultr.com/v1/server/create" \
      -d "DCID=${vultrServerDCID}" \
      -d "VPSPLANID=${vultrServerVPSPLANID}" \
      -d "OSID=${vultrServerOSID}" \
      -d "enable_private_network=${vultrServerEnablePrivateNetwork}" \
      -d "userdata=${vultrServerBase64EncodedUserData}" \
      -d "tag=${vultrServerTag}"
  )
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}

VultrServerDestroy() {
  # ref. https://www.vultr.com/api/#server_destroy
  CheckDependency curl
  vultrServerSUBID="${1:?"$(printf '\n%s\n%s\n%s' "Set \$1: SUBID integer Unique identifier for this subscription." "See:" "  $ vultr server list")"}"
  VultrSetCredentials
  vultrAPIResponse=$(
    curl -sS -H "API-Key: ${VultrAPIKey}" -X POST "https://api.vultr.com/v1/server/destroy" \
      -d "SUBID=${vultrServerSUBID}" \
  )
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}

VultrServerList() {
  # ref. https://www.vultr.com/api/#server_server_list
  CheckDependency curl
  VultrSetCredentials
  vultrAPIResponse=$(curl -sS -H "API-Key: ${VultrAPIKey}" -X GET "https://api.vultr.com/v1/server/list")
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}



##
# sshkey
##
VultrSshkeyCreate() {
  # ref. https://www.vultr.com/api/#sshkey_create
  CheckDependency curl
  vultrSshkeyName="${1:?"$(printf '\n%s' "Set \$1: name string Name of the SSH key")"}"
  vultrSshkeyPublicKey="${2:?"$(printf '\n%s' "Set \$2: ssh_key string SSH public key (in authorized_keys format)")"}"
  VultrSetCredentials
  vultrAPIResponse=$(
    curl -sS -H "API-Key: ${VultrAPIKey}" -X POST "https://api.vultr.com/v1/sshkey/create" \
      -d "name=${vultrSshkeyName}" \
      -d "ssh_key=${vultrSshkeyPublicKey}"
  )
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}

VultrSshkeyDestroy() {
  # ref. https://www.vultr.com/api/#sshkey_destroy
  CheckDependency curl
  vultrSshkeyID="${1:?"$(printf '\n%s\n%s\n%s' "Set \$1: SSHKEYID string Unique identifier for this SSH key." "See:" "  $ vultr sshkey list")"}"
  VultrSetCredentials
  vultrAPIResponse=$(
    curl -sS -H "API-Key: ${VultrAPIKey}" -X POST "https://api.vultr.com/v1/sshkey/destroy" \
      -d "SSHKEYID=${vultrSshkeyID}"
  )
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}

VultrSshkeyList() {
  # ref. https://www.vultr.com/api/#sshkey_sshkey_list
  CheckDependency curl
  VultrSetCredentials
  vultrAPIResponse=$(curl -sS -H "API-Key: ${VultrAPIKey}" -X GET "https://api.vultr.com/v1/sshkey/list")
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}

VultrSshkeyUpdate() {
  # ref. https://www.vultr.com/api/#sshkey_update
  CheckDependency curl
  vultrSshkeyID="${1:?"$(printf '\n%s\n%s\n%s' "Set \$1: SSHKEYID string SSHKEYID of key to update (see /v1/sshkey/list)" "See:" "  $ vultr sshkey list")"}"
  vultrSshkeyName="${2:?"$(printf '\n%s\n%s\n%s' "Set \$2: name string New name for the SSH key" "See:" "  $ vultr sshkey list")"}"
  vultrSshkeyPublicKey="${3:?"$(printf '\n%s\n%s\n%s' "Set \$3: ssh_key string New SSH key contents" "See:" "  $ vultr sshkey list")"}"
  VultrSetCredentials
  vultrAPIResponse=$(
    curl -sS -H "API-Key: ${VultrAPIKey}" -X POST "https://api.vultr.com/v1/sshkey/update" \
      -d "SSHKEYID=${vultrSshkeyID}" \
      -d "name=${vultrSshkeyName}" \
      -d "ssh_key=${vultrSshkeyPublicKey}"
  )
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}



##
# startupscript
##
VultrStartupscriptList() {
  # ref. https://www.vultr.com/api/#startupscript_startupscript_list
  CheckDependency curl
  VultrSetCredentials
  vultrAPIResponse=$(curl -sS -H "API-Key: ${VultrAPIKey}" -X GET "https://api.vultr.com/v1/startupscript/list")
  echo "${vultrAPIResponse}" | VultrJSON 2>/dev/null || VultrPrintStderr "${vultrAPIResponse}"
}



##
# tools
##
VultrToolsGetOSUbuntu1804() { CheckDependency jq; VultrOSList | jq '.[] | select( .name == "Ubuntu 18.04 x64" )'; }
VultrToolsGetPlanRAM1024() { CheckDependency jq; VultrPlansList | jq '.[] | select( .ram == "1024" )'; }
VultrToolsGetDCTokyo() { CheckDependency jq; VultrRegionsList | jq '.[] | select( .name == "Tokyo" )'; }

VultrToolsServerCreateTokyoRAM1024Ubuntu1804() {
  VultrServerCreateWithOptional 25 201 270 yes
}

VultrToolsServerCreateK8sCluster() {
  VultrServerCreateWithOptional 25 201 270 yes
}



##
# main
##
vultrMain() {  ## main start DO NOT REMOVE ##
  subCommand="$1"
  subSubCommand="$2"

  if [ "$2" ]; then shift || true; fi
  if [ "$1" ]; then shift || true; fi

  # shellcheck disable=SC2034
  vultrMainContent=$(
    vultrMainTail=$(tail -n +"$(grep -n "## main start DO NOT REMOVE ##$" "$0" | cut -d: -f1)" "$0")
    echo "${vultrMainTail}" | head -n +"$(echo "${vultrMainTail}" | grep -n "## main end DO NOT REMOVE ##$" | cut -d: -f1)"
  )

  # shellcheck disable=1004,SC2016
  getSubCmds='''
    echo "${vultrMainContent}" \
      | grep -Eo "^ {4}[^ ]+ *)" \
      | grep -Ev "^ {4}(subcmds|\*|completion)" \
      | tr -d "\n" \
      | sed "s/ *//g; s/)/ /g"
  '''

  # shellcheck disable=1004,SC2016
  getSubSubCmds='''
    echo "${vultrMainContent}" \
      | grep -Eo "^( {4}| {8})[^ ]+ *)" \
      | grep -Ev "^ {4}(subcmds|\*)|^ {8}subcmds" \
      | tr -d "\n" \
      | sed "s/.* \(${subCommand} *)[^\*]*\).*/\1/g; s/^${subCommand} *)//g; s/ *//g; s/)/ /g"
  '''

  case "${subCommand}" in
    subcmds)
      eval "${getSubCmds}" ;;
    completion)
      case "${subSubCommand}" in
        subcmds) true ;;
        *      ) echo ". $(cd "$(dirname "$0")"; pwd)/$(basename -- "$0")" ;;
      esac ;;
    configure)
      case "${subSubCommand}" in
        subcmds) true ;;
        *      ) VultrConfigure ;;
      esac ;;
    account)
      case "${subSubCommand}" in
        subcmds) eval "${getSubSubCmds}" ;;
        info   ) VultrAccountInfo "$@" ;;
        *      ) VultrPrintStderr "allowed value: $(bash "$0" "${subCommand}" subcmds)"; return 1 ;;
      esac ;;
    firewall)
      case "${subSubCommand}" in
        subcmds     ) eval "${getSubSubCmds}" ;;
        group-create) VultrFirewallGroupCreate "$@" ;;
        group-delete) VultrFirewallGroupDelete "$@" ;;
        group-list  ) VultrFirewallGroupList "$@" ;;
        *           ) VultrPrintStderr "allowed value: $(bash "$0" "${subCommand}" subcmds)"; return 1 ;;
      esac ;;
    network)
      case "${subSubCommand}" in
        subcmds             ) eval "${getSubSubCmds}" ;;
        create              ) VultrNetworkCreate "$@" ;;
        create-with-optional) VultrNetworkCreateWithOptional "$@" ;;
        list                ) VultrNetworkList "$@" ;;
        *                   ) VultrPrintStderr "allowed value: $(bash "$0" "${subCommand}" subcmds)"; return 1 ;;
      esac ;;
    os)
      case "${subSubCommand}" in
        subcmds) eval "${getSubSubCmds}" ;;
        list   ) VultrOSList "$@" ;;
        *      ) VultrPrintStderr "allowed value: $(bash "$0" "${subCommand}" subcmds)"; return 1 ;;
      esac ;;
    plans)
      case "${subSubCommand}" in
        subcmds) eval "${getSubSubCmds}" ;;
        list   ) VultrPlansList "$@" ;;
        *      ) VultrPrintStderr "allowed value: $(bash "$0" "${subCommand}" subcmds)"; return 1 ;;
      esac ;;
    regions)
      case "${subSubCommand}" in
        subcmds) eval "${getSubSubCmds}" ;;
        list   ) VultrRegionsList "$@" ;;
        *      ) VultrPrintStderr "allowed value: $(bash "$0" "${subCommand}" subcmds)"; return 1 ;;
      esac ;;
    server)
      case "${subSubCommand}" in
        subcmds             ) eval "${getSubSubCmds}" ;;
        create              ) VultrServerCreate "$@" ;;
        create-with-optional) VultrServerCreateWithOptional "$@" ;;
        destroy             ) VultrServerDestroy "$@" ;;
        list                ) VultrServerList "$@" ;;
        *                   ) VultrPrintStderr "allowed value: $(bash "$0" "${subCommand}" subcmds)"; return 1 ;;
      esac ;;
    sshkey)
      case "${subSubCommand}" in
        subcmds) eval "${getSubSubCmds}" ;;
        create ) VultrSshkeyCreate "$@" ;;
        destroy) VultrSshkeyDestroy "$@" ;;
        list   ) VultrSshkeyList "$@" ;;
        update ) VultrSshkeyUpdate "$@" ;;
        *      ) VultrPrintStderr "allowed value: $(bash "$0" "${subCommand}" subcmds)"; return 1 ;;
      esac ;;
    startupscript)
      case "${subSubCommand}" in
        subcmds) eval "${getSubSubCmds}" ;;
        list   ) VultrStartupscriptList "$@" ;;
        *      ) VultrPrintStderr "allowed value: $(bash "$0" "${subCommand}" subcmds)"; return 1 ;;
      esac ;;
    tools)
      case "${subSubCommand}" in
        subcmds                               ) eval "${getSubSubCmds}" ;;
        get-os-ubuntu1804                     ) VultrToolsGetOSUbuntu1804 "$@" ;;
        get-plan-ram1024                      ) VultrToolsGetPlanRAM1024 "$@" ;;
        get-dc-tokyo                          ) VultrToolsGetDCTokyo "$@" ;;
        server-create-tokyo-ram1024-ubuntu1804) VultrToolsServerCreateTokyoRAM1024Ubuntu1804 "$@" ;;
        server-create-k8s-cluster             ) VultrToolsServerCreateTokyoRAM1024Ubuntu1804 "$@" ;;
        *                                     ) VultrPrintStderr "allowed value: $(bash "$0" "${subCommand}" subcmds)"; return 1;;
      esac ;;
    version)
      case "${subSubCommand}" in
        subcmds) true ;;
        *      ) echo "${VULTR_PROGRAM_NAME} ${VULTR_VERSION}" ;;
      esac ;;
    *)
      VultrPrintStderr "allowed value: $(bash "$0" subcmds)"; return 1 ;;
  esac
} && vultrMain "$@"  ## main end DO NOT REMOVE ##

# -- Non Interactive ----------------
else
# -- Interactive ----------------


##
# vultr command as bash-completion
#
# The following function is for bash-completion.
# When executing script as a command,
# the following function is not defined nor executed.
#
# shellcheck disable=SC2016,SC2034,SC2039
##
__complete_vultr() {
  local cur prev cword
  _get_comp_words_by_ref -n : cur prev cword
  if [ "${cword}" -eq 1 ]; then
    eval 'COMPREPLY=( $(compgen -W "'"$(vultr subcmds)"'" -- "${cur}") )'
  elif [ "${cword}" -eq 2 ]; then
    eval 'COMPREPLY=( $(compgen -W "'"$(vultr "${prev}" subcmds)"'" -- "${cur}") )'
  fi
}
# shellcheck disable=SC2039
{ ! command -v complete 1>/dev/null; } || complete -F __complete_vultr vultr

# -- Interactive ----------------
fi
